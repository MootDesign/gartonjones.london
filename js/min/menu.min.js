!function(e){e(document).ready(function(){if(e("#navigation-menu .first a").each(function(){e(this).attr("href").indexOf("news-parallax")>-1?e(this).attr("href","/news-parallax/#news"):e(this).attr("href").indexOf("knowledge-parallax")>-1&&e(this).attr("href","/knowledge-parallax/#knowledge")}),e(window).scroll(function(e){}),e("body").on("flipComplete",function(t,n){var a=e(".big-menu-item").data("origin"),s=a.find("ul > li").length>0;if(!s){var o,l=a.data("url");if(o=Cookies.get("_gj_skip_parallax")?JSON.parse(Cookies.get("_gj_skip_parallax")):{},"/knowledge/"!=l||o.knowledge||(l="/knowledge-intro/#knowledge",o.knowledge=!0),Cookies.set("_gj_skip_parallax",JSON.stringify(o)),""!==l)return i(l),!1}Cookies.get("skip-parallax")&&0!=Cookies.get("skip-parallax")||e(".big-menu-item").find("ul > li a").each(function(){var i=e(this).data("title");switch(i){case"News":e(this).attr("href","/news-parallax/#news"),console.log(this);break;case"Blog":e(this).attr("href","/news-parallax/#blog");break;case"Press":e(this).attr("href","/news-parallax/#press");break;case"All about London":e(this).attr("href","/knowledge-parallax/#knowledge");break;case"Video":e(this).attr("href","/developments-parallax/#video")}})}),e(window).width()<767){var n=e(window).height(),s=e(".top-bar").height(),o=e(".site-footer").height(),l=(n-s-o)/8;e(".site-menu .menu-list .menu-item").css({height:l}).data("menuH",l)}e(window).resize(function(){if(e(window).width()<767){var i=e(window).height(),t=e(".top-bar").height(),n=e(".site-footer").height(),a=(i-t-n)/8;e(".site-menu .menu-list .menu-item").css({height:a}).data("menuH",a)}else e(".site-menu .menu-list .menu-item").css({height:""});var a=e(window).height()-e(".top-bar").height()-e(".site-footer").height();e("#menu").css({height:a})}),e("#mobilemenutrigger a").click(function(){e(this).find(".hamburger").toggleClass("close"),e("#mtrigger a#changethis").trigger("click")}),e("#mtrigger a#changethis, .show-menu").click(function(){setTimeout(function(){e("#register").toggle()},250),e(".top-bar").toggleClass("expanded");var i=e(".site-menu"),t=i.hasClass("visible"),n=e(".bottomlogo2 img"),a=e(".toplogo");if(void 0===n.data("isVisible")&&n.data("isVisible",n.is(":visible")),t)e(".site-menu .button-close").trigger("click"),n.data("isVisible")&&(n.fadeIn(),a.removeClass("visible")),e("#foot .gradient").fadeIn(),e(this).html("menu");else{var s=document.documentElement.clientHeight,o=e(".top-bar").height();e(window).width()<767?s-=o:s=s-2*o-12,i.height(s).toggleClass("visible").css("top",o),a.addClass("visible"),n.fadeOut(),e("#foot .gradient").fadeOut(),e("#changethis").html("close"),showClose(500,"#menu")}return!1}),e(".site-menu .menu-item").click(function(){e(".big-menu-item").length>0?a(e(this)):t(e(this))}),e(".site-menu .menu-item a").click(function(){var t=e(this).attr("href");i(t),e("#mobilemenutrigger a").trigger("click"),e("body").trigger("mobileChangePage")}),e(".site-menu .button-close").click(function(){setTimeout(function(){e("#register").toggle()},250);var i=600;e("#menu .button-close, #menu .button-close *").removeClass("open"),e(".big-menu-item").length>0&&(a(!0),i=600),setTimeout(function(){e(".site-menu").removeClass("visible"),e("#changethis").html("menu")},i)}),e("body").on("click",".big-menu-item",function(){e(this).hasClass("loading")||a(!0)}),e("body").on("click",".big-menu-item a",function(){var t=e(this).attr("href");return a(!0),i(t),!1}),e(window).width()>768&&(e(".site-menu .menu-item.has-video").mouseenter(function(){var i=e(this);$video=i.find("video"),e(this).hasClass("menu-item-7")?$video.css({left:"auto",right:0}):$video.css({left:(i.width()-$video.width())/2}),$video.addClass("play");var t=$video.get();t[0].play(),t[0].currentTime=0}).mouseleave(function(){var i=e(this),t=i.find("video"),n=t.get();n[0].pause(),n[0].currentTime=0,t.removeClass("play")}),e(".site-menu .menu-item.has-music").mouseenter(function(){var i=e(this);$music=i.find("audio"),$music.addClass("play");var t=$music.get();t[0].play(),t[0].currentTime=0}).mouseleave(function(){var i=e(this),t=i.find("audio"),n=t.get();n[0].pause(),n[0].currentTime=0,t.removeClass("play")}))});var i=function(i){var t=e(".big-menu-item");t.addClass("loading"),t.fadeOut("slow",function(){e(this).remove()}),i!=window.location?e(".menu-list").fadeOut("slow",function(){window.location.href=i,-1!=i.search("#")&&(e(".site-menu .button-close").trigger("click"),e(this).delay(1e3).fadeIn())}):e(".site-menu .button-close").trigger("click")},t=function(i){if(e(window).width()<767)return 0==i.find("ul li").length&&window.location.assign(i.data("url")),e(".site-menu .menu-list .menu-item").children("h3").show(),e(".site-menu .menu-list .menu-item").children("ul").hide(),e(".site-menu .menu-list .menu-item").animate({height:parseInt(e(".site-menu .menu-list .menu-item").data("menuH"))},600),i.hasClass("open-menu")?(e(".site-menu .menu-list .menu-item").removeClass("open-menu"),!1):(e(".site-menu .menu-list .menu-item").removeClass("open-menu"),e(i).finish().animate({height:285},600,function(){i.addClass("open-menu")}),setTimeout(function(){i.children("h3").fadeOut(),i.children("ul").fadeIn()},500),!1);$clone=e("<div>").append(i.html()),$clone.addClass("big-menu-item menu-item-"+i.index()).data("origin",i),$clone.find("video").remove(),$clone.css("background-image",i.css("background-image"));var t=i.parent().offset(),a=i.position();if(i.index()%4===0){var s=e(".site-menu .menu-list").width();s-=.89*e(".site-menu .menu-list").width();var o=s/2;$clone.data("x",o)}if((i.index()+1)%4===0){var o=.925*a.left;$clone.data("x",o-a.left)}$clone.css({top:a.top+t.top,left:a.left+t.left,width:i.outerWidth(),height:i.outerHeight()}),i.css({opacity:0}),e("body").append($clone);var l={width:.8*i.outerWidth(),height:.8*i.outerHeight()},r={x:(i.outerWidth()-l.width)/2,y:(i.outerHeight()-l.height)/2};i.offset().top<100&&(r.y*=-1),i.offset().left<jQuery(document).width()/2&&(r.x*=-1),e(window).width()>767?e(".site-menu .menu-list").addClass("zoomed").transition({scale:.8,y:r.y,x:r.x},200,"linear"):(e(".site-menu .menu-list").addClass("zoomed"),e(".big-menu-item").css({top:i.offset().top+i.height()+35}),i.animate({height:285},375)),n($clone,-90);var u='<div class="button-close" style="top: 5px; right: 5px;"><div class="circle-arc"><svg width="100%" viewBox="0 0 100 100"><path d="M 50 50 m -43 0 a 43 43 0 1 1 86 0 a 43 43 0 1 1 -86 0"></path></svg></div><div class="bg"><div></div></div><div class="line l-0"></div><div class="line l-1"></div></div>';e(window).width()<767&&($clone.append(u),showClose(600,".big-menu-item"))},n=function(i,n,a){var s=parseInt(i.data("x"))*(0>n);e(window).width()>767?i.toggleClass("flip").transition({perspective:"1000px",rotateX:n+"deg",x:s},200,"linear",function(){e(this).toggleClass("visible")}):(i.toggleClass("visible"),285==i.height()?i.css({height:i.data("height")}):(i.data("height",i.height()),i.css({height:285}),e("body").trigger("flipComplete",e(this))),i.addClass("active")),e(window).width()>767&&setTimeout(function(i,t,n){var a=void 0===n?"flipComplete":"";i.transition({rotateX:-1*t+"deg"},0),i.transition({rotateX:"0deg"},200,"linear",function(){e(this).addClass("active"),a&&e("body").trigger("flipComplete",e(this))})},200,i,n,a),void 0!==a&&setTimeout(function(i){var n=e(".big-menu-item");n.data("origin").css({opacity:1}),n.remove(),"object"==typeof i&&t(i),e("body").trigger("flipDestroyes")},400,a)},a=function(i){if(e(".site-menu .menu-list").removeClass("zoomed").transition({scale:1,y:0,x:0},200,"linear"),e(window).width()<767){var t=e(window).height(),a=e(".top-bar").height(),s=e(".site-footer").height(),o=(t-a-s)/8;e(".site-menu .menu-list .menu-item").animate({height:o},200).data("menuH",o)}n(e(".big-menu-item"),90,i)};e(document).ready(function(){e("#big-menu").find(".button-close").click(function(){e(this).removeClass("open"),e("#big-menu").removeClass("open")}),e(".search-popup").click(function(){e("#search-popup").addClass("visible"),showShade(100,!0),showClose(1e3,"#search-popup");var i=document.getElementById("video-search");i.play()})})}(jQuery),jQuery(document).ready(function(){!function(e){var t,n=200,a=100,s=900,o=0,l=0,r=function(i){var t=i.find(".first").width()/2,s=i.find(".first li"),o=Math.floor(s.length/2),l=s.length%2===0;if(l){var r=e(s.get(o));t+=r.position().left-t+r.outerWidth()/2}s.each(function(i){var a=e(this),s=a.position(),l=t-a.outerWidth()/2;l-=s.left;var r="translateX( "+l+"px)";a.css({webkitTransform:r,MozTransform:r,msTransform:r,OTransform:r,transform:r});var u=o-i,d=n*Math.abs(u);setTimeout(function(e,i){e.addClass("visible"),0===i&&e.addClass("middle"),e.css({webkitTransform:"",MozTransform:"",msTransform:"",OTransform:"",transform:""})},d,a,u)});var d=i.find(".first").outerWidth();d-=s.first().outerWidth()/2,d-=s.last().outerWidth()/2,setTimeout(function(e,i){e.find(".line").addClass("visible").width(i).css({marginLeft:-i/2-5})},n*(o+1),i,d),setTimeout(function(i){i.each(function(i){var t=e(this).find("span");setTimeout(function(){t.addClass("visible")},i*a,t)}),setTimeout(function(){u()},n)},n*(o+2),s)},u=function(){var i=e("#navigation-menu .second li");if(!(i.length<=0)){i.each(function(i){setTimeout(function(e){e.addClass("visible")},i*(2*a),e(this))});var t=i.parent().outerWidth();t-=i.last().outerWidth()/2;var n=e("#navigation-menu .second").outerWidth();n-=i.last().outerWidth()/2,n-=e("#navigation-menu .second .line-thin").position().left,setTimeout(function(i){e("#navigation-menu .second .line-fat").addClass("visible"),e("#navigation-menu .second .street-sign + li a").trigger("click"),setTimeout(function(i){e("#navigation-menu .second .line-thin").addClass("visible").width(i)},s,n)},a*i.length+s,t)}},d=function(){var i=e("#navigation-menu .second"),n=e("#navigation-menu .second li"),a=i.outerWidth();a-=n.last().outerWidth()/2,a-=e("#navigation-menu .second .line-thin").position().left,e("#navigation-menu .second .line-thin").addClass("resize").width(a);var s=t.position().left-e("#navigation-menu .second .line-fat").position().left+t.outerWidth()/2;e("#navigation-menu .second .line-fat").width(s-10)};e(document).ready(function(){e(".navigation-menu .second a").click(function(){var n=e(this),a=!1;if(e("#navigation-menu .second a").removeClass("active full"),e("#navigation-menu .second li").removeClass("active full"),n.parent().hasClass("sub-item")||e("#navigation-menu .second li.open").length>0&&(e("#navigation-menu .second li").removeClass("open"),a=!0),e(this).closest(".navigation-menu").hasClass("noall"))e(this).closest(".second").find("a").removeClass("full"),e(this).parent().addClass("full");else{var s=n.parent().index();for(i=0;i<s;i++){var r=e("#navigation-menu .second li").get(i);e(r).find("a").addClass("full")}}if(!n.parent().hasClass("sub-item")&&n.parent().next().hasClass("sub-item")){var s=n.parent().index(),u=e("#navigation-menu .second li");for(i=s+1;i<u.length;i++){var r=u.get(i);if(!e(r).hasClass("sub-item"))break;e(r).addClass("open")}a=!0}if(n.addClass("active"),a)clearInterval(o),clearTimeout(l),o=setInterval(d,10),l=setTimeout(function(){clearInterval(o),e("#navigation-menu .second .line-fat").removeClass("resize"),$active=e("#navigation-menu li a.active").parent();var i=$active.position().left-e("#navigation-menu .second .line-fat").position().left+$active.outerWidth()/2;e("#navigation-menu .second .line-fat").width(i-10),setTimeout(function(){var i=e("#navigation-menu li a.active").parent();i.next()},10)},500);else{var c=e(this).parent().position().left-e("#navigation-menu .second .line-fat").position().left+e(this).parent().outerWidth()/2,h=e(this).parent().hasClass("sub-item")?3:10;e("#navigation-menu .second .line-fat").width(c-h)}return t=e("#navigation-menu li a.active").parent(),!1})}),e(document).ready(function(){e("#parallax-wrapper").length>0&&e("#parallax").length<=0&&e("#navigation-menu").addClass("relative"),e("#navigation-menu").hasClass("onload")&&setTimeout(function(){e(".navigation-menu").each(function(){r(e(this))})},500)}),e(window).load(function(){e("#navigation-menu").hasClass("onload")||e(".navigation-menu").each(function(){r(e(this))})})}(jQuery)}),jQuery(document).ready(function(){!function(e){var t=100,n=300,a=1e3,s=200,o=function(){e("#back-history .tube").each(function(i){var t=e(this),n=t.closest(".items").outerWidth()-e(this).position().left;t.hasClass("tube-last")&&(n/=2),e(this).delay(a+i*s).animate({width:n},s,"linear")})};e("#back-button").click(function(){e("#back-history").addClass("visible"),e("#back-history .items").each(function(i){var n=e(this).find(".shade"),s=n.data("width");n.delay(t*(i+1)).animate({width:s},a,"easeOutExpo")}),setTimeout(function(){e("#back-history .items").each(function(i){setTimeout(function(e){e.find(".button-close").length>0?(e.find(".button-close").addClass("open"),o()):e.find("a").addClass("visible")},n*i,e(this))})},1*a)}),e(".items.blank").click(function(){e("#back-history .button-close").trigger("click")}),e("#back-history .show-menu").click(function(){e("#mtrigger").trigger("click"),e("#back-history .button-close").trigger("click")}),e("#back-history .button-close").click(function(){var o=e("#back-history .items"),l=o.length-2,r=a+.4*(l+1)*n;for(i=l;i>=0;i--)setTimeout(function(e){e.find("a").removeClass("visible")},a+n*(l-i-1),e(o.get(i))),setTimeout(function(e){e.find(".tube").animate({width:0},s/2,"linear")},a/2+1*n,e(o.get(i)));for(o=e("#back-history .items"),l=o.length,i=l;i>=0;i--){var u=o.get(i),d=e(u).find(".shade");d.delay(r+t*(l-i)).animate({width:0},a/2,"easeOutExpo")}setTimeout(function(){e("#back-history").removeClass("visible")},a+t*l)}),e(window).load(function(){var i=0;e("#back-history .items").each(function(t){var n=e(this).find(".shade"),a=n.width();n.data("width",a).css({width:0}),i+=a-2});var t=e("#back-history ").width()-i;e("#back-history .items.blank").width(t).find(".shade").data("width",t).css({width:0}),e("#back-button").addClass("visible")})}(jQuery)});