function initAzLayout(){var t=jQuery("#az-list"),e=t.find("li").outerWidth(),a=t.find(".active");jQuery("#az-list .selector").width(e-4).css({left:a.offset().left}).animate({opacity:1})}function loadKnowledgeData(t,e){var a=e,i=t;_xhr=jQuery.ajax({type:"post",url:_ajaxurl,data:{action:"get_knowledge_details",id:i.data("id"),nonce:_nonce},success:function(e){var i;try{i=jQuery.parseJSON(e)}catch(s){return!1}var o={_details:i};t.data("xhr",o),void 0!==a&&(showMarkerDetails(o,!1),showKnowledgeDetail(a))}})}function showKnowledgeDetail(t){var e=(document.documentElement.clientWidth-t.width())/2,a=(e-t.position().left)/2,i=(document.documentElement.clientHeight-t.height())/2,s=(i-t.position().top)/2,o=jQuery("#markerDetails"),r=(document.documentElement.clientWidth-o.outerWidth())/2,n=(document.documentElement.clientHeight-o.outerHeight())/2;o.addClass("no-transition az-marker").css({left:t.position().left+a,top:t.position().top+s}).transit({perspective:"500px",rotateY:"90deg",scale:.2,opacity:1},0).data("left",r).data("cx",t.position().left+a).data("top",n).data("cy",t.position().top+s).find(".x-close").addClass("no-close"),jQuery(t).transit({x:a,y:s,perspective:"500px",rotateY:"-90deg",scale:1.5},"fast","linear",function(){var t=o.data("left")-o.data("cx"),e=o.data("top")-o.data("cy");jQuery("#markerDetails").transit({x:t,y:e,scale:1,opacity:1,rotateY:"0deg"},"fast","linear")})}function parallaxAnimate(t){var e=$(t);e.fadeIn()}function recreate_coverflow(t){_recreate_coverflow&&(_coverflows.forEach(function(e){jQuery("#"+e.dest).fadeOut("fast",function(){jQuery(this).html(""),_recreate_coverflow_data(e,t)})}),_recreate_coverflow=!1)}function _recreate_coverflow_data(t,e){var a=document.getElementById(t.dest),i=document.createElement("ul"),s=document.createElement("ul"),o=!0;i.id=t.id,i.classList.add("coverflow-me"),i.style.display="none",i.dataset.dest=t.dest,s.dataset.cat="+ Category one",i.appendChild(s),e=e.toLowerCase(),t.data.forEach(function(t){if(!(""!==e&&t.letter!=e||ajaxData.filter&&""!==ajaxData.filter&&ajaxData.filter!=t.marker&&ajaxData.filter!=t.type)){var a=document.createElement("ul"),i='<li data-type="link" data-url="'+t.link+'"></li><li data-thumbnail-path="'+t.img+'"></li><li data-thumbnail-text=""><div class="flowWrapper" style="float: left; width: 100%; height: auto; padding-top: 5px"><p class="largeLabel"><a href="'+t.link+'">'+t.title+'</a></p><ul class="options" style="display: none"><li></li></ul></p></div></li>';a.innerHTML=i,s.appendChild(a),o=!1}}),a.appendChild(i),o||(generateCoverflow(),jQuery("#"+t.dest).show())}var _recreate_coverflow=!1;!function(t){t(window).load(function(){function e(){a.width()/a.height()<s?i.removeClass().addClass("bgheight"):i.removeClass().addClass("bgwidth")}var a=t(window),i=t("#bg-body"),s=i.width()/i.height();a.resize(e).trigger("resize")})}(jQuery),jQuery(window).load(function(){jQuery(".responsive-grid").trigger("reflow")}),jQuery(document).ready(function(t){t("#az-list").length>0&&jQuery(window).resize(function(){initAzLayout()}),t(".the-strips li").mouseenter(function(){t("#bg img").removeClass("active"),t("#bg ."+t(this).data("image")).addClass("active")}),t(".arrows > div").click(function(){var e=t(this).hasClass("arrow-left")?-1:1,a=t(".grid-view.active"),i=e>0?a.next(".grid-view"):a.prev(".grid-view"),s=e>0?"next":"";i.length<=0||(a.removeClass("next active").addClass(s),i.removeClass("next").addClass("active"))})}),jQuery(document).ready(function(t){t("#az-list li").click(function(){_recreate_coverflow=!0,t("#az-list li").removeClass("active"),t(this).addClass("active");var e=t(this).data("item").toLowerCase();ajaxData.letter=e,""!==e?(t("#az .the-strips li").slideUp(function(){t(this).hide()}),t('#az .the-strips li[data-letter="'+e+'"]').stop(!0,!1).show().slideDown(),ajaxData.type&&""!==ajaxData.type?(t("#grid li").addClass("hide-me"),t('#grid li[data-category="'+ajaxData.category+'"],#grid li[data-type="'+ajaxData.type+'"]').each(function(){t(this).data("letter")==e&&t(this).removeClass("hide-me")})):(t("#grid li").addClass("hide-me"),t('#grid li[data-letter="'+e+'"]').removeClass("hide-me"))):(t("#az .the-strips li").slideDown(),t("#grid li").removeClass("hide-me"),ajaxData.type&&""!==ajaxData.type&&(t("#grid li").addClass("hide-me"),t('#grid li[data-category="'+ajaxData.category+'"]').removeClass("hide-me"),t('#grid li[data-type="'+ajaxData.type+'"]').removeClass("hide-me"))),t("#map").is(":visible")&&(t("#spinner").addClass("visible"),gmapShowMarkers(map)),t("#coverflow").is(":visible")&&recreate_coverflow(e),t(".responsive-grid").trigger("reflow")}),t("#az .block").each(function(){loadKnowledgeData(t(this))}),t("#az .block").click(function(){_xhr&&_xhr.abort();var e=t(this);t("#az .block").not(e).addClass("inactive"),jQuery("#menugrayout").addClass("no-close").fadeIn();var a=e.clone();a._original=e,a.show().addClass("full-block").css({left:e.offset().left,top:e.offset().top,width:e.outerWidth(),height:e.outerHeight()}),jQuery("body").append(a),jQuery(this).transit({scale:0,opacity:0},0),jQuery(".mb50.mt8p .block").each(function(t){var e=jQuery(this);e!=a._original&&e.delay(60*t).transit({scale:0,opacity:0},"fast","easeInBack",function(){jQuery(this).css("opacity","")})}),void 0===a._original.data("xhr")?loadKnowledgeData(a._original,a):(showMarkerDetails(a._original.data("xhr"),!1),showKnowledgeDetail(a))}),t("body").on("click","#markerDetails.no-transition .x-close",function(){jQuery("#markerDetails");jQuery("#markerDetails").transit({x:0,y:0,scale:.2,rotateY:"90deg"},"fast","linear",function(){t("#menugrayout").fadeOut(),jQuery("#markerDetails").removeClass("no-transition").find(".x-close").removeClass("no-close");var e=jQuery(".full-block")._original;jQuery(".mb50.mt8p .block").each(function(t){$this=jQuery(this),$this!=e&&$this.delay(60*t).transit({scale:1,opacity:1},"fast","easeOutBack")}),jQuery(".full-block").transit({x:0,y:0,perspective:"500px",rotateY:"0deg",scale:1},"fast",function(){$this=jQuery(this),jQuery($this._original).transit({scale:1,opacity:1},0),$this.remove()})})})}),jQuery(document).ready(function(t){function e(e,i){e.find(".title").each(function(){var e=t(this),s=e.find(".title-row span"),o=e.find(".title-row2 span"),r=0===i?"ease-in":"linear",n=0===i?0:20,l=400;a(s),s.each(function(e){var a=t(this).index();t(this).stop(!0,!1).delay(e*c).transition({rotateX:i+"deg",y:n},l,r);var s=o.get(a);t(s).stop(!0,!1).delay(e*c).transition({rotateX:i+"deg",y:-n},l,r)})})}function a(t){for(var e,a,i=t.length;0!==i;)a=Math.floor(Math.random()*i),i-=1,e=t[i],t[i]=t[a],t[a]=e;return t}function i(a){a=a||1200,setTimeout(function(){t("#latest .latest ul").each(function(a){t(this).delay(200*a).transition({y:0,opacity:1},800,"easeOutQuad",function(){e(t(this),0),t(this).find(".category,.more").addClass("active")})})},a)}function s(e){t("#az-list li").each(function(){if(""!==this.dataset.item){var t=this.dataset.item.toLowerCase();e.indexOf(t)<0?this.classList.add("empty"):this.classList.remove("empty")}})}t("#parallax-wrapper").hasClass("tablet")&&t("#coverflow").show(),t("#parallax-wrapper").hasClass("mobile")&&(t("#grid").removeClass("hide").show(),t(".responsive-grid").trigger("reflow"));var o=[];t("#az li").each(function(){t(this);o.push(this.dataset.letter.toLowerCase())}),s(o),t(".change-view li, .show-latest").click(function(){return t("#back-button").show(),t(".categories-toggle, #az-list").removeClass("hidden"),t(".switchers li").removeClass("active"),$this=t(this),$this.addClass("active"),t(".xactive").hide(),t($this.data("id")).removeClass("hide").show().addClass("xactive"),t("body").attr("class",t("body").attr("class").replace(/.tab-[^ ]*/,"")),t("body").addClass("tab-"+$this.data("id")),t(".responsive-grid").trigger("reflow"),$this.data("noaz")?t("#az-list").addClass("hidden"):t("#az-list").removeClass("hidden"),t(this).hasClass("show-latest")?t("#latest").removeClass("hide"):t("#latest").addClass("hide"),"#coverflow"==$this.data("id")&&recreate_coverflow(t("#az-list li.active").data("item")),"#latest"!=$this.data("id")?t("#categories .description").addClass("hide"):t("#categories .description").removeClass("hide"),"#grid"==$this.data("id")&&(t("img.lazy").lazyload(),t("#grid").scroll(function(){t("img.lazy").lazyload()})),$this.data("map")&&(t("#map").hasClass("initialized")||(t("#back-button").hide(),initGMap("map",51.506423,-.125631,!0,!1,12),t("#map").addClass("initialized"))),$this.attr("data-id")?!1:void 0}),t(".switchers .icon-switch").click(function(){var e=t("#photo .container");e.hasClass("initialized")||(e.addClass("initialized"),e.css({marginLeft:-e.width()/2,marginTop:-e.height()/2}),e.mouseParallax({moveFactor:5,targetContainer:"#photo"}),setTimeout(function(e){for(var a=pindrops.length,i=["bank","concerts","famous","flash","historic-buildings","movies","public-places","wifi"],s=0,o=10,r=700,n=(e.height()/3,0);a>n;n++){var l=t("<img>").hide(),d=pindrops[n].x,h=pindrops[n].y,c=Math.random()*i.length;c=i[Math.floor(c)];var u=ajaxData.markersUrl+c+".png";l.addClass("pin").attr("src",u).css({left:d+"%",top:h+"%"}).data("category",c),l.data("src",pindrops[n].src),l.data("title",pindrops[n].title),l.data("link",pindrops[n].link),l.click(function(e){var a=t(this),i=t("#pin-infowindow");i.find("img").attr("src",a.data("src")),i.show();var s=a.position().left+a.width()/2-t("#pin-infowindow").outerWidth()/2,o=a.position().top-t("#pin-infowindow").outerHeight()-20;i.find("span").html(a.data("title")),i.find("a").attr("href",a.data("link")),i.css({left:s,top:o})}),e.append(l),l.transition({y:-l.position().top},0).show(),l.delay(s+n*o).transition({y:0},r,"easeOutBounce")}},1e3,e))}),t("#pin-infowindow").click(function(){t(this).hide()}),t(".switchers a.icon-360").trigger("click"),t(".categories-toggle").click(function(){t(".categories-list").toggleClass("hidden"),t(this).html(t(".categories-list").hasClass("hidden")?"Show full directory":"Hide full directory")}),t(".categories a, .categories-list a").click(function(){_recreate_coverflow=!0;var e=t(this).find(".title").html();void 0===e?e="":(e=e.replace("Show",""),e=e.trim(),e="Showing "+e),t(".category-name").html(e).addClass("border-line"),ajaxData.filter=this.dataset.filter,""===t(this).data("type")?(ajaxData.category=t(this).data("filter"),ajaxData.type="knowledge"):(ajaxData.category="",ajaxData.type=t(this).data("type"));var a=t(this).data("filter"),i=t(".row.mt8p > div").not(".hide");(i.length<=0||"latest"==i.attr("id"))&&t(".switchers .default-view").trigger("click"),t("#map").hasClass("xactive")&&gmapShowMarkers(map),t("#photo img").each(function(){var e=t(this);""===a||e.data("category")==a?e.stop(!0,!1).fadeIn():e.stop(!0,!1).fadeOut()});var o=[];t("#az li").each(function(){var e=t(this);if(""===a||e.hasClass(a)||e.hasClass("post-"+a)){if(o.push(this.dataset.letter.toLowerCase()),!e.data("height"))return;e.stop(!0,!1).show().animate({height:e.data("height"),opacity:1},"slow")}else e.data("height")||e.data("height",e.outerHeight()),e.stop(!0,!1).animate({height:0,opacity:0},"slow",function(){t(this).hide()})}),s(o),t("#coverflow").is(":visible")&&recreate_coverflow(t("#az-list li.active").data("item")),""!==a?(t("#grid li").addClass("hide-me"),t('#grid li[data-category="'+a+'"]').removeClass("hide-me"),t('#grid li[data-type="'+a+'"]').removeClass("hide-me")):t("#grid li").removeClass("hide-me"),t(".responsive-grid").trigger("reflow"),t(this).closest("#latest").length<=0&&(t(".categories-list").toggleClass("hidden"),t(".categories-toggle").html(t(".categories-list").hasClass("hidden")?"Show full directory":"Hide full directory"))});var r=window.innerWidth/3.8,n=r/2.6,l=10;window.innerWidth<640?(r=window.innerWidth/1.2,n=r/.9,l=.2*window.innerWidth):window.innerWidth<1025&&(r=window.innerWidth/2,n=r/2);var d=r/(16/9),h=-r+n,c=30,u=0,f=[];t("#latest .arrow").width(n/1.4).height(d),t("#latest .latest").data("slideWidth",r).data("slideHalfWidth",n),t("#latest .container").height(d),t("#skip").click(function(){t("#overlay-boxes .box1").delay(1e3).transition({y:"-200%"},800,function(){t(this).hide()}),t("#overlay-boxes .box2").delay(1e3).transition({y:"200%"},800,function(){t(this).hide()});var e=jQuery(".columns.switchers").outerHeight()-7,a=(jQuery("#home").height()-e-jQuery("#footer").outerHeight(),jQuery("#latest"));a.css({top:e}),t(this).fadeOut()}),t(".scroll-down").click(function(){i()}),t(window).load(function(){t("parallax").length<=0&&(t("#overlay-boxes .box1").delay(800).transition({y:"-200%"},800,function(){t(this).hide()}),t("#overlay-boxes .box2").delay(800).transition({y:"200%"},800,function(){t(this).hide()}),void 0!=_show_filter&&_show_filter&&(t('#categories a[data-filter="'+_show_filter+'"]').trigger("click"),t(".categories-list").addClass("hidden")),i(700),video1.play())}),t("#latest .latest ul").each(function(a){var i=t(this);i.width(r),i.height(d),i.css({left:h}),i.transition({y:window.innerHeight-t(this).offset().top},0),i.mouseenter(function(){e(t(this),90)}).mouseleave(function(){e(t(this),0)}),h+=r+l,f.push(this)}),t("#latest .left-arrow").mouseenter(function(e){var a=t(this).parent().find(".latest");a.stop(!0,!1).transition({x:u+100},"ease")}).mouseleave(function(){var e=t(this).parent().find(".latest");e.stop(!0,!1).transition({x:u},"ease")}),t("#latest .right-arrow").mouseenter(function(e){var a=t(this).parent().find(".latest");a.stop(!0,!1).transition({x:u-100},"ease")}).mouseleave(function(){var e=t(this).parent().find(".latest");e.stop(!0,!1).transition({x:u},"ease")}),t("#latest .arrow").click(function(){if(!t(this).hasClass("animating")){t(this).addClass("animating");var e,a=t(this).hasClass("right-arrow"),i=t(this).parent().find(".latest"),s=i.data("slideWidth"),o=(i.data("slideHalfWidth"),getMatrixM40(i.get()[0])),r=1,n=s+l,d=1;a?(e=f.shift(),f.push(e),r=f.length-2,d=-1):(e=f.pop(),f.unshift(e),n*=-1),a||(n+=parseFloat(f[r].style.left),t(e).css({left:n})),u=o+(s+l)*d-100*d,i.stop(!0,!0).transition({x:u+100*d},"ease",function(){a&&(n+=parseFloat(f[r].style.left),t(e).css({left:n})),t("#latest .arrow").removeClass("animating")})}})}),jQuery(window).load(function(){if(jQuery("article.animated-text").parent().css({left:"25%"}),jQuery("#categories").length)var t=jQuery("#categories").position().top+jQuery("#categories").height()-jQuery(".mb50.mt8p").position().top-2;var e=0;jQuery("#latest").children().each(function(){e+=jQuery(this).outerHeight(!0)});var a=jQuery("#latest");a.css({top:t}).css({minHeight:e});var i=jQuery(window).height()-(jQuery(".top-bar").height()+jQuery("#navigation-menu").height()+jQuery(".overlayed-bar").height()+jQuery("#az-list").height()+jQuery(".site-footer").height()+jQuery("#bottom-bar").height()+15);jQuery("#parallax-wrapper").hasClass("mobile")||jQuery(".mb50.mt8p").height(i)}),jQuery(window).resize(function(){var t=jQuery(window).height()-(jQuery(".top-bar").height()+jQuery("#navigation-menu").height()+jQuery(".overlayed-bar").height()+jQuery("#az-list").height()+jQuery(".site-footer").height()+jQuery("#bottom-bar").height()+15);jQuery("#parallax-wrapper").hasClass("mobile")||jQuery(".mb50.mt8p").height(t)}),function(t){t.fn.extend({mouseParallax:function(e){var a={moveFactor:5,rotateFactor:5,zIndexValue:"-1",targetContainer:"body"};return e=t.extend(a,e),this.each(function(){var a=e,i=t(this);t(a.targetContainer).on("mousemove",function(e){mouseX=e.pageX,mouseY=e.pageY,windowWidth=t(window).width(),windowHeight=t(window).height(),percentX=mouseX/windowWidth*a.moveFactor-a.moveFactor/2,percentY=mouseY/windowHeight*a.moveFactor-a.moveFactor/2,leftString=0-percentX+"%",rightString=0-percentX+"%",topString=0-percentY+"%",bottomString=0-percentY+"%",rotateX=mouseX/windowWidth*a.rotateFactor-a.rotateFactor/2+"deg",rotateY=mouseY/windowHeight*a.rotateFactor-a.rotateFactor/2+"deg",i[0].style.transform="translateX("+leftString+") translateY("+topString+") rotateX("+rotateY+") rotateY( "+rotateY+")"})})}})}(jQuery);