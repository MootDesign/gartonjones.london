! function($) {
    function setParallaxContentHeight() {
        $("#parallax .content").height(window.innerHeight - $("nav.top-bar").outerHeight() - $("#footer").outerHeight() - $("#sub-menu").outerHeight()), $("#parallax > .empty").height($(".site-footer").height() + 40)
    }

    function adjustBigControls() {
        $("#gallery .arrows").fadeOut();
        var $controls = $("#big-controls"),
            width = $(".big-image.current").width();
        $controls.width(width + 200).removeClass("no-events").addClass("visible").fadeIn()
    }

    function showTheSearchButton() {
        (0 === activeSlide || activeSlide == $("#parallax > .content").length) && ($("#register").hasClass("open") || $(".parallax #register .title").first().trigger("click")), isScrolling || 0 >= activeSlide || ($("#register").hasClass("open") && $(".parallax #register .title").first().trigger("click"), $(".the-title").fadeIn(), $(".parallax .content.active").hasClass("no-search") || $("#parallax > .search-button").addClass("visible"))
    }

    function scrollTheGallery(dir) {
        var $current = $("#gallery .images .current"),
            current = $current.index() + dir;
        current >= $("#gallery .images .image").length && (current = 0), $("#gallery .images .image").each(function() {
            var $this = $(this);
            $this.removeClass(function(index, css) {
                return (css.match(/\b(before-|after-)\S+/g) || []).join(" ")
            }).removeClass("current before after");
            var id = $this.index() - current;
            if (Math.abs(id) > 3) {
                var sign = id > 0 ? -1 : 1;
                id = $("#gallery .images .image").length + id * sign, id *= sign
            }
            var c = 0 > id ? "before before-" : "after after-";
            0 === id && (c = "current id-"), $this.addClass(c + Math.abs(id))
        }), $("#image-desc li").removeClass("active");
        var li = $("#image-desc li").get(current);
        $(li).addClass("active")
    }

    function showTheGallery3D() {
        $("#gallery .images .image").removeClass("hidden"), $("#gallery .arrows").removeClass("single")
    }

    function showTheGallerySingle() {
        $("#gallery .images .image").addClass("hidden"), $("#gallery .arrows").addClass("single")
    }

    function setUpGallery() {
        var ratio = 16 / 9;
        $("#gallery .image").height($("#gallery .current").width() / ratio);
        var mLeft = ($("#gallery .current").width() - $("#gallery .images").width()) / 2,
            mTop = ($("#gallery .current").height() - $("#gallery .images").height()) / 2;
        $("#gallery .image").css({
            marginLeft: mLeft,
            top: -mTop
        })
    }

    function setUpTheAboutSlides() {
        if ($("#about .slides")) {
            var width = 0;
            $("#about .slides .slide").each(function() {
                width += $(this).width()
            }), $("#about .slides").width(width + 20), $(".the-about-content #images .image").each(function() {
                var $this = $(this),
                    data = $this.data("alt").split(","),
                    x = window.innerWidth * (data[0] + 1);
                $this.transition({
                    x: x,
                    opacity: 1
                }, 0).data("speed", data[1]).delay(data[2])
            })
        }
    }

    function centerTheAboutSlides() {
        $(".keyfacts .scrollable").width(getTotalWidth($(".keyfacts .scrollable .page")) + 40), $(".keyfacts .scrollable .page").width($(".slide .keyfacts").width()), $(".slides .slide-content, .center-me").each(function() {
            var $this = $(this),
                top = ($this.parent().outerHeight() - $this.outerHeight()) / 2;
            top = Math.max(0, top);
            var $arrows = $(this).next(".arrows");
            if ($arrows.length > 0) {
                var w = $(this).width() / 2;
                $arrows.find(".arrow-left").transition({
                    x: -w - 60
                }, 0), $arrows.find(".arrow-right").transition({
                    x: w + 30
                }, 0), $arrows.find("div").addClass("visible")
            }
            $this.css({
                top: top
            })
        })
    }

    function splitTheContent() {
        $(".split-me").each(function() {
            var $this = $(this),
                minColumn = $this.data("columns") || 2,
                maxHeight = $this.closest(".slide-content").height() - maxHeightOffset,
                height = $this.height(),
                $scrollable = $this.closest(".scrollable");
            height > maxHeight && ($this.data("max", maxHeight), splitTheParagraphs($this, $this.data("class")), $this.closest(".columns").remove());
            var $columns = $scrollable.find("> .columns"),
                width = (parseInt($columns.first().css("padding-left")), $columns.first().outerWidth()),
                isFullWidth = $columns.first().hasClass("medium-12"),
                fullWidth = isFullWidth ? width : 2 * width,
                halfWidth = fullWidth / 2,
                totalColumns = $columns.length;
            $columns.each(function(i) {
                $(this).hasClass("medium-12") && totalColumns++, i > 0 && i % minColumn === 0 && $(this).addClass("padding")
            });
            var $padded = $scrollable.find(".columns.padding"),
                total = getTotalWidth($columns) + maxHeightOffset * $padded.length;
            $scrollable.find("> .columns").each(function() {
                var w = halfWidth;
                $(this).hasClass("medium-12") && (w = fullWidth), $(this).css({
                    width: w
                })
            }), $scrollable.width(total + 10);
            var pages = Math.ceil(totalColumns / minColumn),
                $ul = $scrollable.closest(".slide").find("ul.dots");
            for (i = 0; i < pages; i++) {
                var $li = $("<li>");
                $ul.append($li)
            }
            $ul.data("cpp", minColumn), $ul.find("li").first().addClass("active")
        })
    }

    function splitTheParagraphs($source, className) {
        var $column = $("<div>").addClass("columns").addClass(className);
        $source.closest(".scrollable").append($column), $lastItem && ("H4" == $lastItem.prop("tagName") && ($lastItem.detach(), $column.append($lastItem)), $lastItem = null), $source.find("> div > *").each(function() {
            var $p = $(this),
                maxHeight = $p.closest(".split-me").data("max");
            return $p.outerHeight() + $column.outerHeight() <= maxHeight ? ($p.detach(), $column.append($p), void($lastItem = $p)) : (splitTheParagraphs($source, className), !1)
        })
    }

    function setTheActiveSlide() {
        var top = $(window).scrollTop();
        isScrolling = !0, top > 0 ? $("nav.top-bar").addClass("opaque") : $("nav.top-bar").removeClass("opaque"), $content.each(function(k) {
            var $this = $(this),
                index = k,
                minTop = $(window).scrollTop() + window.innerHeight / 3,
                visible = $this.offset().top <= minTop && $this.offset().top + $this.height() >= minTop;
            if (visible) {
                if (activeSlide != index) {
                    var li = $("#dots li").get(index - 1);
                    $("#dots li").removeClass("active"), $(li).addClass("active"), $("#sub-menu li").removeClass("active");
                    var menu = $("#sub-menu ul li").get(k);
                    $(menu).addClass("active"), $content.removeClass("active"), $(this).addClass("active")
                }
                activeSlide = index
            }
        }), $("#parallax > .search-button").removeClass("visible"), clearTimeout(scrollingTimeout1), clearTimeout(scrollingTimeout2), scrollingTimeout1 = setTimeout(function() {
            isScrolling = !1, scrollingTimeout2 = setTimeout(function() {
                showTheSearchButton()
            }, 300)
        }, 100)
    }

    function animateTheAboutImages() {
        var currentSection = $(".parallax-menu .active").index() - 1;
        $(".the-about-content #images .image").each(function() {
            var $this = $(this),
                data = $this.data("alt").split(","),
                speed = 1e3 * data[1],
                delay = 1e3 * data[2],
                x = (data[0] == currentSection ? "easeOutExpo" : "easeInExpo", window.innerWidth * data[0] - window.innerWidth * currentSection);
            $this.stop(!0, !1).delay(delay).transition({
                x: x
            }, 2 * speed)
        })
    }

    function requestFullScreen(element) {
        var requestMethod = element.requestFullScreen || element.webkitRequestFullScreen || element.mozRequestFullScreen || element.msRequestFullscreen;
        if (requestMethod) requestMethod.call(element);
        else if ("undefined" != typeof window.ActiveXObject) {
            var wscript = new ActiveXObject("WScript.Shell");
            null !== wscript && wscript.SendKeys("{F11}")
        }
    }

    function centerForm() {
        $("#forms").css("margin-top", -$("#forms").height() / 2)
    }

    function initThePage() {
        {
            var $theRegister = $("#register > .the-content"),
                cheight = $theRegister.height();
            window.innerHeight - $theRegister.offset().top - $("#footer").height() - 40
        }
        $theRegister.data("height", cheight).height(0), showTheSearchButton(), setParallaxContentHeight(), setUpGallery(), scrollTheGallery(0), setUpTheAboutSlides(), splitTheContent(), centerTheAboutSlides(), setTheActiveSlide();
        var $slideText = $("#slide-text");
        setInterval(function() {
            var $active = $slideText.find(".active"),
                $next = $active.next();
            $next.length <= 0 && ($next = $slideText.find("li").first()), $active.removeClass("active"), $next.addClass("active")
        }, 4e3), $(window).scrollTop(0), $(window).scroll(function() {
            setTheActiveSlide()
        }), $(".full-screen").click(function() {
            var $this = $(this);
            return isFullScreen() ? (document.exitFullscreen ? document.exitFullscreen() : document.msExitFullscreen ? document.msExitFullscreen() : document.mozCancelFullScreen ? document.mozCancelFullScreen() : document.webkitExitFullscreen && document.webkitExitFullscreen(), $this.removeClass("exit")) : (requestFullScreen(document.body), $this.addClass("exit")), !1
        })
    }
    var scrollingTimeout1, scrollingTimeout2, $content = $("#parallax .content"),
        activeSlide = 0,
        isScrolling = !1,
        isDragging = !1,
        dragStart = 0,
        maxHeightOffset = 150,
        $lastItem = null;
    $("#dots li").click(function() {
        var div = $("#parallax .content").get($(this).index()),
            top = isFullScreen() ? $(div).position().top : $(div).offset().top,
            pos = top - $("#sub-menu").outerHeight() - $("nav.top-bar").outerHeight();
        $("html, body").stop(!0, !1).animate({
            scrollTop: pos
        }, 1e3, "easeInExpo", function() {
            1 == activeSlide && (animateTheAboutImages(), $(".parallax-menu .submenu li.active a").trigger("click")), isFullScreen() && setTheActiveSlide()
        })
    }), $(window).resize(function() {
        setParallaxContentHeight(), setUpGallery(), setUpTheAboutSlides(), $("#dots li.active").trigger("click")
    }), $(".translate-me").mousemove(function(e) {
        var x = e.clientX / window.innerWidth - .5,
            y = (e.pageY - $(this).offset().top) / window.innerHeight,
            tx = 30 * -x,
            ty = 30 * -y;
        $(this).stop(!0, !1).transition({
            x: tx,
            y: ty
        }, 0, "easeOutSine")
    }), $("#gallery .arrows > .arrow-right").click(function() {
        $("#gallery .current"), $("#gallery .current").index()
    }), $("#gallery .arrows > div").click(function() {
        scrollTheGallery($(this).hasClass("arrow-right") ? 1 : -1)
    }), $("#gallery .images").mousedown(function(e) {
        isDragging = !0, dragStart = e.clientX
    }).mouseup(function() {
        isDragging = !1
    }).mousemove(function(e) {
        if (!isDragging) return !1;
        var dir = dragStart - e.clientX;
        if (Math.abs(dir) > 10) {
            e.preventDefault();
            var c = dir > 0 ? "right" : "left";
            $("#gallery .arrows .arrow-" + c).trigger("click"), isDragging = !1
        }
        return !1
    }), $("#gallery .images .image, #gallery .images img").on("dragstart", function(e) {
        return e.preventDefault(), !1
    }), $("body").on("click", "#gallery .current, .example-gallery .columns", function() {
        big = new Image;
        var bigImg = $(this).find("img").data("big");
        big.onload = function() {
            $this = $(this), $this.addClass("big-image current").hide(), $("body").append($this);
            var $current = this._source,
                scaleX = ($this.width(), $current.width() / $this.width()),
                scaleY = $current.height() / $this.height();
            $current.hasClass("columns") && (scaleX = scaleY = 0, $current = $current.find("img")), $this.transition({
                x: "-50%",
                y: "-50%",
                scale: [scaleX, scaleY]
            }, 0).data("scale", [scaleX, scaleY]).show(), $this.transition({
                x: "-50%",
                y: "-50%",
                scale: 1
            }, "fast", "easeOutSine", function() {
                var $this = $(this),
                    $button = $(".button-close-me");
                $button.css({
                    left: $this.position().left + $this.width() - $button.outerWidth() - 10,
                    top: $this.position().top + 10
                }), $button.addClass("visible"), adjustBigControls()
            }), $("#big-shade").fadeIn()
        }, big._source = $(this), big.dataset.id = $(this).find("img").data("id"), big.src = bigImg
    }), $("#big-shade, body > .button-close-me").click(function() {
        var scale = $(".big-image").data("scale");
        $("body > .big-image").transition({
            x: "-50%",
            y: "-50%",
            scale: scale
        }, "fast", function() {
            $(".big-image").remove()
        }), $("#gallery .arrows").fadeIn(), $("#big-shade").fadeOut(), $("#big-controls").removeClass("visible").fadeOut(), $("body > .button-close-me").removeClass("visible")
    }), $(".read-more").click(function() {
        var $content = $(this).closest(".content"),
            $more = $content.find(".more-text");
        showShade(), $more.removeClass("close").addClass("visible")
    }), $("article.parallax a").click(function() {
        var href = $(this).attr("href");
        if ("#" == href[0]) {
            var $li = $("#dots li.class-" + href.substr(1));
            return $li.trigger("click"), !1
        }
    }), $("#big-controls > div").click(function() {
        var $this = $(this),
            $big = $(".big-image.current"),
            sourceId = $big.data("id"),
            $source = $("#gallery .images .image-" + sourceId),
            $image = $this.hasClass("arrow-left") ? $source.prev() : $source.next();
        $image.length <= 0 && $this.hasClass("arrow-left") && ($image = $source.closest(".images").find(".image").last()), $image.length <= 0 && !$this.hasClass("arrow-left") && ($image = $source.closest(".images").find(".image").first()), $("#big-controls").addClass("no-events");
        var big = new Image,
            bigImg = $image.find("img").data("big");
        big.onload = function() {
            var $this = $(this);
            $this.addClass("big-image").addClass(this._direction > 0 ? "to-right" : "to-left");
            var $current = $(".big-image.current");
            $("body").append($this), setTimeout(function(dir, $current, $this) {
                $current.addClass("animate").addClass(0 > dir ? "to-right" : "to-left").removeClass("current"), $this.addClass("animate current").removeClass("to-right to-left")
            }, 100, this._direction, $current, $this), setTimeout(function($current) {
                $current.remove(), adjustBigControls()
            }, 600, $current)
        }, big._source = $image, big._direction = $this.hasClass("arrow-left") ? -1 : 1, big.dataset.id = $image.find("img").data("id"), big.src = bigImg
    }), $("#register .title").click(function() {
        var $this = $(this),
            $content = $this.parent().find(".the-content");
        if ($this.parent().toggleClass("open"), "register" == $(this).parent().attr("id")) {
            var currentHeight = $this.parent().hasClass("open") ? $content.data("height") : 0;
            0 === currentHeight ? showTheGallery3D() : showTheGallerySingle(), $content.height(currentHeight)
        }
    }), $("#about .parallax-menu a").click(function() {
        var $this = $(this),
            index = $(this).parent().index() - 1,
            slide = $("#about .slides .slide").get(index),
            x = slide.offsetLeft;
        return $this.data("darker") ? $(".parallax .shadow").addClass("darker") : $(".parallax .shadow").removeClass("darker"), 1 == $this.data("map") ? ($("#location-map").addClass("visible"), showShade(600, !0), setTimeout(function() {
            var $location = $("#mapholder");
            $location.data("initialized") ? $location.fadeIn("fast") : (vmap($location.data("latitude"), $location.data("longitude"), $("#mapholder").next(".map-info")), $location.data("initialized", 1))
        }, 600), !1) : ($(".show-me .animate-me").removeClass("show"), $("#about .slides").stop(!0, !1).transition({
            x: -x
        }, 1e3, "easeInExpo", function() {
            setTimeout(function() {
                animateVisibleContent()
            }, 100)
        }), $(".parallax-menu li").removeClass("active"), $this.parent().addClass("active"), animateTheAboutImages(), !1)
    }), $("body").on("click", ".slide .dots li", function() {
        var $this = $(this),
            $scrollable = $this.closest(".slide").find(".scrollable"),
            $ul = $this.parent(),
            index = $this.index(),
            cpp = $ul.data("cpp"),
            to = $this.index() * cpp,
            toIndex = $this.index(),
            from = $ul.find(".active").index(),
            $columns = $scrollable.find("> .columns");
        $columns.each(function(i) {
            var pos = 100 * (i + 1),
                $col = $(this),
                delay = i;
            if (from > toIndex) {
                var max = from * cpp + 1;
                delay = max - i
            }
            delay *= 200, i >= to && (pos = to + cpp > i ? 100 * cpp * index : 0, i >= 0 && cpp > i && (pos = 0)), $col.delay(delay).stop(!0, !1).transition({
                x: -pos + "%",
                marginLeft: 0
            }, 1e3, "easeInOutExpo")
        }), $ul.find("li").removeClass("active"), $this.addClass("active")
    }), $('#contact input[type="text"], #contact input[type="email"], #contact input[type="tel"], #contact textarea').focusin(function() {
        $(this).closest("li").find("label").addClass("focused")
    }).focusout(function() {
        $(this).val().length || $(this).closest("li").find("label").removeClass("focused")
    });
    $(".pager, .pager-arrows .arrow").click(function() {
        var $this = $(this),
            currentPage = $this.index();
        if ($this.find(".arrows").stop(!0, !1).fadeIn(), $this.hasClass("arrow")) {
            var dir = $this.hasClass("arrow-left") ? -1 : 1;
            currentPage = $(".pager li.active").index() + dir
        }
        0 >= currentPage && (currentPage = 0, $(".page-arrows .arrow-left").stop(!0, !1).fadeOut()), currentPage >= $(".pager li").length && (currentPage = $(".pager li").length - 1, $(".page-arrows .arrow-right").stop(!0, !1).fadeOut()), $(".keyfacts .scrollable .page").each(function(i) {
            var $page = $(this);
            $page.removeClass("to-screen from-screen").addClass("show"), currentPage > i && $page.addClass("from-screen").removeClass("show"), i > currentPage && $page.addClass("to-screen").removeClass("show")
        })
    }), $("table.facilities td").mouseenter(function() {
        var src = this.dataset.src;
        if (void 0 !== src) {
            $(".parallax .shadow").addClass("lighter");
            var $img = $("#facilities-bg img.active").next();
            (!$img || $img.length <= 0) && $("#facilities-bg img").first(), console.log($("#facilities-bg img"), "ciao"), $("#facilities-bg img").removeClass("visible"), $img.attr("src", src).addClass("visible")
        }
    }), $(document).ready(function() {
        setTimeout(function() {
            initThePage()
        }, 500)
    }), $(window).load(function() {
        centerForm(), setTimeout(function() {
            $("#vertical-boxes .box1").transition({
                x: "-100%"
            }), $("#vertical-boxes .box2").transition({
                x: "100%"
            }), $("#loadingText").removeClass("show").addClass("to-screen"), $(".parallax .shadow").addClass("visible"), $("#register").addClass("visible"), setTimeout(function() {
                $("#parallax").find("#home .text").addClass("visible")
            }, 800)
        }, 200)
    }), document.addEventListener("keydown", function(e) {
        13 == e.keyCode && $(".full-screen").removeClass("exit")
    }, !1), $(document).ready(function() {
        $(".toggle-radio").click(function() {
            if (!$(".radio-would").is(":visible")) {
                $(this).text("I would like to:").addClass("no-arrow"), $(".radio-would").slideDown(400);
                var updateInterval = setInterval(function() {
                    var updateHeight = $(".the-content").data("height") + $(".radio-would").height() + 5;
                    $(".the-content").height(updateHeight)
                }, 50);
                $(".radio-would").promise().done(function() {
                    clearInterval(updateInterval), setTimeout(function() {
                        $(".the-content").data("height", $(".the-content").height())
                    }, 100)
                })
            }
        }), $("#gform_14").find("input, select, textarea").focus(function() {
            $(".toggle-radio").trigger("click")
        }), $(".property-worth .title").click(function() {
            $(".stamp-duty").hasClass("open") && $(".stamp-duty").toggleClass("open").find(".form-content").slideUp(), $(this).parent().toggleClass("open").find(".form-content").slideToggle()
        }), $(".stamp-duty .title").click(function() {
            $(".property-worth").hasClass("open") && $(".property-worth").toggleClass("open").find(".form-content").slideUp(), $(this).parent().toggleClass("open").find(".form-content").slideToggle()
        })
    })
}(jQuery);